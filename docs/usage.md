# 使用方法

## 基本フロー

```
1. APIキーを設定（初回のみ）
         ↓
2. Slackメッセージをテキストエリアに貼り付け
         ↓
3. 「AI分解する」をクリック（または Cmd+Enter）
         ↓
4. タスクカードが生成される（今日 / 今週 / 来週 の3カラムに自動配置）
         ↓
5. 返答テンプレをコピーして Slack に貼り付け
```

---

## 入力例

テキストエリアには Slack のメッセージをそのまま貼り付ける。箇条書きや改行が含まれていても問題ない。

```
認証周りのバグ直してほしい。本番で出てるやつ
```
```
来週までにダッシュボードのAPIをv2に移行したい
```
```
サーバーのメモリ使用率が高騰してるので調査して
```
```
DBのスロークエリが増えてるっぽい。原因特定してインデックス追加まで対応できる？
```

---

## タスクカードの見方

生成されるカードには以下の情報が含まれる。

| 項目 | 内容 |
|---|---|
| 優先度バッジ | 高（赤）/ 中（黄）/ 低（青） |
| タイトル | AIが生成した20文字以内のタスク名 |
| 概要 | 50文字程度の作業内容サマリー |
| 工数・日数 | 合計時間 h と 実働日数（1日6時間換算） |
| 優先度スコア | 緊急度・影響範囲・複雑度から算出した 0〜100 の数値 |
| サブタスク | 具体的な作業単位ごとの時間とレイヤー（▶ で展開） |
| 工数根拠 | 見積もりの根拠説明（▶ で展開） |
| 返答テンプレ | Slackにそのまま貼れる返信文。📋 ボタンでコピー |
| ステータス | 未着手 → 進行中 → 完了 をボタンで切り替え |

### サブタスクのレイヤーアイコン

| アイコン | layer | 意味 |
|---|---|---|
| 🖥 | `infra` | サーバー・インフラ系作業 |
| 📱 | `app` | アプリ・フロントエンド系作業 |
| ⚡ | `both` | インフラ・アプリ両方にまたがる作業 |

---

## ボード（3カラム）の見方

| カラム | 配置条件 | ヘッダー色 |
|---|---|---|
| 今日やること | urgency ≥ 4 または 本番障害 | 赤 |
| 今週やること | urgency = 3 | 黄 |
| 来週以降 | urgency ≤ 2 | 青 |

各カラム内は **優先度スコアの降順** で表示される。

### 自動移動

「今日」の合計工数が **6時間を超えた** 場合、優先度が `high` でないタスクが自動的に「今週」に移動される。
移動されたタスクには「自動移動」バッジが表示され、画面上部にインフォバナーが出る。

---

## バッファを追加する

AI生成後のカードで「⏱ バッファ」ボタンを押すとパネルが開く。

### 追加方法

**時間を加算：**

| プリセット | 加算時間 |
|---|---|
| +2h | 2時間 |
| +4h | 4時間 |
| +1日(6h) | 6時間 |
| カスタム | 任意の時間（0.5刻み） |

**倍率をかける：**

| プリセット | 倍率 |
|---|---|
| ×1.2 | 1.2倍（0.5刻みで丸め） |
| ×1.5 | 1.5倍 |
| ×2.0 | 2倍 |
| カスタム | 任意の倍率 |

### 操作手順

1. バッファの追加方法を選ぶ（時間 or 倍率）
2. プリセットをクリック、またはカスタム欄に数値を入力
3. 理由メモを入力（任意）例：「レビュー待ち・環境不安定を考慮」
4. 「再生成する →」をクリック

バッファ理由を自然な文体で含む **返答テンプレが再生成** され、カードに「バッファ済」バッジが付く。

---

## PROJECT.md でコンテキストを注入する

プロジェクト固有の情報をAIに渡すことで、見積もりと返答テンプレの精度が上がる。

### 読み込み方法

- ヘッダーの「📄 コンテキスト未設定」をクリックしてファイルを選択
- またはブラウザ画面上に `.md` / `.txt` ファイルをドラッグ&ドロップ

読み込み完了後、ヘッダーに「📄 ファイル名」と緑バッジが表示される。
✕ ボタンで削除・差し替え可能。

### PROJECT.md フォーマット例

```markdown
## システム概要
- サービス名: 〇〇サービス
- 構成: マイクロサービス
- 主要言語: Go / TypeScript

## インフラ構成
- クラウド: AWS (ECS)
- DB: MySQL 8.0

## デプロイルール
- 本番デプロイ可能日時: 毎週水曜 10〜12時のみ
- 手順: GitHub PR → レビュー2名 → マージ → 自動デプロイ

## チーム状況
- エンジニア人数: 3名
- レビュー待ち目安: 1〜2営業日
- 障害対応フロー: Slackの #incident チャンネルに報告

## 注意事項
- DBマイグレーションは必ず別PRで分割すること
- 外部API連携はレート制限に注意（100req/min）
```

### 精度向上の例

```
// PROJECT.md なし
rationale: "本番デプロイが必要なため+0.5時間"

// PROJECT.md あり（「本番デプロイは水曜のみ」の情報が入っている場合）
rationale: "本番デプロイは水曜10〜12時のみ。今日火曜の場合は翌水曜まで待機が発生。
            DBマイグレーションを伴う場合は別PR必要で+1日の工数増を見込むこと。"
```

---

## その他の操作

| 操作 | 方法 |
|---|---|
| 返答テンプレをコピー | カード内の 📋 ボタン |
| ステータス変更 | カード内の「着手する / 完了する / 戻す」ボタン |
| 全タスク削除 | ヘッダーの「🗑 全クリア」ボタン |
| APIキーの変更 | ヘッダーの「APIキー設定」ボタン |
