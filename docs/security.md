# セキュリティ・制限事項

## セキュリティ方針

このツールはローカル単一ユーザー向けに設計されており、以下の方針に基づいて実装されている。

### APIキーの取り扱い

| 項目 | 方針 |
|---|---|
| 保存場所 | Flaskサーバーのインメモリ（Python `dict`）のみ |
| ブラウザ側への保存 | `localStorage` / `sessionStorage` / Cookie への保存なし |
| ログへの出力 | なし |
| 永続化 | なし。サーバー再起動でリセットされる |

ブラウザからFlaskへはAPIキーを直接送るのは設定時（`POST /api/set-key`）の1回のみ。
その後の Claude API 呼び出しはすべてFlask（サーバーサイド）で行われるため、ブラウザ → 外部への流出経路がない。

### 通信経路

```
ブラウザ ──(localhost)──► Flask ──(HTTPS)──► Anthropic API
```

- ブラウザ ↔ Flask 間はローカルループバック（`127.0.0.1:5000`）のみ
- Flask ↔ Anthropic API 間は HTTPS（anthropic Python SDKが処理）

### データの保持

| データ | 保持場所 | 消去タイミング |
|---|---|---|
| タスク | インメモリ（`_tasks` dict） | サーバー再起動時 |
| APIキー | インメモリ（`_api_key` dict） | サーバー再起動時 |
| PROJECT.md | インメモリ（`_project_context` dict） | サーバー再起動時、またはユーザーが削除したとき |

ファイルへの書き込みは一切行わない。

---

## 制限事項

### データの永続化なし

- タスクはサーバー再起動で消える（インメモリ保存のため）
- ブラウザを閉じてもサーバーが動いていればデータは残る
- APIキーも再起動で消えるため、起動のたびに再入力が必要

### シングルユーザー前提

- タスク・APIキー・PROJECT.md はサーバー上のグローバル変数として保持される
- 複数のブラウザタブや別のPCから同じサーバーにアクセスすると、データが共有・上書きされる
- 本ツールは1人のユーザーがローカルで使用する前提で設計されている

### インターネット接続が必要

- **Tailwind CSS** — Play CDN (`cdn.tailwindcss.com`) からロードされる。オフライン時はスタイルが崩れる
- **Claude API** — タスク生成・バッファ再生成のたびに Anthropic のAPIサーバーへリクエストが飛ぶ

### 外部公開不可

`app.run(debug=True)` はローカル開発専用の設定。

- `debug=True` は任意のコードを実行できるデバッガを有効にするため、外部公開すると深刻なセキュリティリスクになる
- デフォルトの起動設定（`host` 未指定）では `127.0.0.1` にバインドされるため、ローカルネットワークからもアクセスできない

> 外部公開が必要な場合は、Gunicorn などの本番用WSGIサーバーを使用し、`debug=False` にすること。

### AIによる推定

- 工数見積もりはClaude APIによる推定値であり、実際の工数とは異なる場合がある
- 本番環境での意思決定に使用する際はバッファ調整機能で補正すること
- サブタスクの分割粒度や工数配分はプロジェクトの実態と異なる場合がある
